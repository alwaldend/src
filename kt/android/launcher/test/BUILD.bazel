load("@rules_kotlin//kotlin:android.bzl", "kt_android_local_test")
load("//bzl/rules/bzl:al_bzl_target_doc.bzl", "al_bzl_target_doc")
load("//bzl/rules/git:al_git_changelog.bzl", "al_git_changelog")

al_git_changelog(
    name = "changelog",
    visibility = ["//:__subpackages__"],
)

[
    kt_android_local_test(
        name = "{}_test".format(file.replace(".kt", "")),
        size = "small",
        srcs = [file],
        manifest = "//kt/android/launcher:manifest",
        test_class = "com.alwaldend.src.kt.android.launcher.{}".format(file.replace(".kt", "")),
        deps = [
            "//kt/android/launcher/main:launcher_library",
            "@com_alwaldend_src_maven_android//:junit_junit",
            "@com_alwaldend_src_maven_android//:org_robolectric_robolectric",
            "@rules_robolectric//bazel:android-all",
        ],
    )
    for file in glob(["**/*.kt"])
]

# load("@rules_android//android:rules.bzl", "android_instrumentation_test", "android_library")
#
# android_instrumentation_test(
#     name = "inst",
#     target_device = "@android_test_support//tools/android/emulated_devices/generic_phone:android_36_x86",
#     test_app = "//kt/android/launcher:launcher_binary",
# )

al_bzl_target_doc(
    name = "bazel_target_doc",
    visibility = ["//:__subpackages__"],
)
